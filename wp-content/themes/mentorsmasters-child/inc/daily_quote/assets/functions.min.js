
function gooDailyQ( container ){
	
	this.container = container;
	this.clip_cont = this.container.getElementsByClassName( 'goo-dailyq-clipping-container' )[0];
	this.insts = this.clip_cont.getElementsByClassName( 'goo-dailyq-content-inst' );
	this.queue = this.insts.length;
	this.active_ele = this.insts[Math.floor(Math.random() * this.queue)];
	
	this.active_index = (Math.random() * (this.queue - 0)).toFixed(0);
	if( candyjar.api.getCookie( "MMdailyq" ) ){
		this.pre_vals = candyjar.api.getCookie( "MMdailyq" );
		// console.log( typeof this.pre_vals );
			
		if( typeof this.pre_vals === 'object' ){
			if( this.pre_vals.length > 5 )
				this.pre_vals = this.pre_vals.slice(0, 5);
		}
		
		for( var i = 0, n = this.pre_vals.length; i < n; i++ ){
			
			this.pre_vals[i] = this.pre_vals[i].replace(/^id=/gi, "");
			
			while( this.pre_vals[i] === this.active_index ){
				this.active_index = (Math.random() * (this.queue - 0)).toFixed(0);
			}
			// console.log( this.active_index );
			// console.log( this.pre_vals[i] );
		}
	}
	
	this.sizeMe();
	this.trackMe();
	this.setActive();
}

gooDailyQ.prototype = {
	
	sizeMe : function(){		
		height_collect = new Array();
		width_collect = new Array();
		for( var i=0, n=this.insts.length; i<n; i++ ){
			height_collect.push( this.insts[i].offsetHeight );
			width_collect.push( this.insts[i].offsetWidth );
		}
		var dialyqHeight = Math.max.apply( Math, height_collect );
		var dailyqWidth = Math.max.apply( Math, width_collect );
		for( var i=0, n=this.insts.length; i<n; i++ ){
			this.insts[i].style.height = dialyqHeight + "px";
			this.insts[i].style.width = dailyqWidth + "px";
		}
		this.clip_cont.style.width = dailyqWidth * this.queue + "px" ;
		
		this.dailyqWidth = dailyqWidth;
		// console.log( this.active_ele );
	},
	
	trackMe : function(){
		
		vals = new Array( this.active_index );
		if( typeof this.pre_vals === 'object' && this.pre_vals.length > 0 ){
			for( var i = 0, n = this.pre_vals.length; i<n; i++ ){
				vals.push( this.pre_vals[i] );
			}
			
			vals = vals.slice( 0, 5 );
			// console.log( "pre: "+vals );
		}
		
		for( var i = 0, n = vals.length; i<n; i++ ){
			
			
			
		}
		
		var cookie_date = new Date();
		cookie_date = cookie_date.setMonth( cookie_date.getMonth() + 12 );
		var name = "MMdailyq", subname = "id", value = this.active_index, expire = cookie_date, path = null, domain = null, secure = false;
		
		candyjar.api.setCookie( name, subname, value, expire, path, domain, secure );
		
	},
	
	setActive : function(){
		
		x_pos = ( this.active_index * this.dailyqWidth );
		
		this.clip_cont.style.transform = "translate3d( -" + x_pos + "px, 0px, 0px )";
		
		// console.log( this.active_index );
		
	},
}


if( document.getElementsByClassName( 'goo-dailyq-container' ).length > 0 ){
	var dailyq_inst = document.getElementsByClassName( 'goo-dailyq-container' );
	for( var i=0, n=dailyq_inst.length; i<n; i++ ){
		new gooDailyQ( dailyq_inst[i] );
	}
}